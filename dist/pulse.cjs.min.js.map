{"version":3,"file":"pulse.cjs.min.js","sources":["../lib2/helpers.ts","../lib2/interfaces.ts","../lib2/runtime.ts","../lib2/dep.ts","../lib2/reactive.ts","../lib2/action.ts","../lib2/computed.ts","../lib2/collection.ts","../lib2/subController.ts","../lib2/storage.ts","../lib2/collections/request.ts","../lib2/collections/base.ts","../node_modules/@babel/runtime/helpers/defineProperty.js","../node_modules/@babel/runtime/helpers/objectSpread.js","../node_modules/@babel/runtime/helpers/classCallCheck.js","../node_modules/@babel/runtime/helpers/createClass.js","../node_modules/@babel/runtime/helpers/typeof.js","../node_modules/@babel/runtime/helpers/assertThisInitialized.js","../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js","../node_modules/@babel/runtime/helpers/getPrototypeOf.js","../node_modules/@babel/runtime/helpers/setPrototypeOf.js","../node_modules/@babel/runtime/helpers/inherits.js","../lib2/wrappers/ReactWithPulse.js","../lib2/relationController.ts","../lib2/library.ts"],"sourcesContent":["export const protectedNames = [\n  'data',\n  'indexes',\n  'groups',\n  'computed',\n  'actions',\n  'routes'\n];\n\nexport const collectionFunctions = [\n  'collect',\n  'replaceIndex',\n  'getGroup',\n  'newGroup',\n  'deleteGroup',\n  'removeFromGroup',\n  'update',\n  'increment',\n  'decrement',\n  'delete',\n  'purge',\n  'watch',\n  'findById',\n  'put',\n  'move',\n  'throttle',\n  // deprecated\n  'remove'\n];\n\nexport function defineConfig(config, defaults) {\n  return { ...defaults, ...config };\n}\n\nexport function uuid() {\n  return (\n    Math.random()\n      .toString()\n      .split('.')[1] + Date.now()\n  );\n}\n\nexport function objectLoop(object, callback, keys?: Array<any>) {\n  const objectKeys = keys ? keys : Object.keys(object);\n  for (let i = 0; i < objectKeys.length; i++) {\n    const key: string = objectKeys[i];\n    const value: any = object[key];\n    callback(key, value, objectKeys);\n  }\n}\n\n// const thing = {}\n// objectLoop(thing, (thingKey, thingItem) => {\n\n// })\n\nexport function log(value: any, payload?: any) {\n  // console.log(`Pulse / ${value}`, payload ? payload : ' ');\n}\n\nexport function normalizeMap(map) {\n  return Array.isArray(map)\n    ? map.map(key => ({ key, val: key }))\n    : Object.keys(map).map(key => ({ key, val: map[key] }));\n}\n\nexport const arrayFunctions = [\n  'push',\n  'pop',\n  'shift',\n  'unshift',\n  'splice',\n  'sort',\n  'reverse'\n];\n\nexport function assert(\n  func: (warnings: { [key: string]: any }) => any,\n  funcName?: string\n) {\n  function warn(message) {\n    // if (funcName) console.log(`PULSE // \"${funcName}()\" :: ${message}`);\n    // else console.warn(`PULSE :: ${message}`);\n    return false;\n  }\n  const warnings = {\n    NO_PRIMARY_KEY: () => warn('No primary key found!'),\n    INVALID_PARAMETER: () => warn('Invalid parameter supplied to function.'),\n    INDEX_NOT_FOUND: () => warn('Index was not found on collection.'),\n    INTERNAL_DATA_NOT_FOUND: () => warn('Data was not found on collection.'),\n    PROPERTY_NOT_A_NUMBER: () => warn('Property is not a number!')\n  };\n  return func(warnings)();\n}\n\nexport function isWatchableObject(value) {\n  function isHTMLElement(obj) {\n    try {\n      return obj instanceof HTMLElement;\n    } catch (e) {\n      return (\n        typeof obj === 'object' &&\n        obj.nodeType === 1 &&\n        typeof obj.style === 'object' &&\n        typeof obj.ownerDocument === 'object'\n      );\n    }\n  }\n  let type = typeof value;\n  return (\n    value != null &&\n    type == 'object' &&\n    !isHTMLElement(value) &&\n    !Array.isArray(value)\n  );\n}\n\nexport function validateNumber(mutable, amount) {\n  if (typeof amount !== 'number' || typeof mutable !== 'number') {\n    return false;\n  }\n  return true;\n}\n","import SubController from './subController';\nimport Runtime from './runtime';\nimport Collection from './collection';\nimport Dep from './dep';\nimport Action from './action';\nimport Computed from './computed';\n\nexport interface ExpandableObject {\n  [key: string]: any;\n}\n\nexport interface RequestConfig {\n  baseURL?: string;\n  requestIntercept?: () => void;\n  responseIntercept?: () => void;\n  mode?: 'cors' | 'same-origin' | 'no-cors' | 'navigate';\n  credentials?: 'omit' | 'same-origin';\n  include?: any;\n  headers?: ExpandableObject;\n  saveHistory?: boolean;\n  timeout?: number;\n}\n\nexport interface Watcher {\n  collection: string;\n  property: string;\n}\n\nexport interface RootConfig {\n  framework?: any;\n  frameworkConstructor?: any;\n  waitForMount?: boolean;\n  autoUnmount?: boolean;\n  enableBase: boolean;\n  enableRequest: boolean;\n}\nexport interface CollectionConfig {}\n\nexport interface CollectionObject {\n  config?: CollectionConfig;\n  data?: object;\n  persist?: Array<string>;\n  groups?: Array<string>;\n  actions?: object;\n  computed?: object;\n  filters?: object;\n  watch?: object;\n  routes?: object;\n  model?: object;\n  local?: object;\n  // private\n  indexes?: object;\n}\n\nexport interface RootCollectionObject extends CollectionObject {\n  config?: RootConfig;\n  request?: object;\n  collections?: object;\n}\n\nexport interface Methods {\n  collect?: void;\n  replaceIndex?: void;\n  getGroup?: void;\n  newGroup?: void;\n  deleteGroup?: void;\n  removeFromGroup?: void;\n  update?: void;\n  increment?: void;\n  decrement?: void;\n  delete?: void;\n  purge?: void;\n  watch?: void;\n  findById?: void;\n}\n\nexport interface Keys {\n  data?: Array<string>;\n  computed?: Array<string>;\n  actions?: Array<string>;\n  indexes?: Array<string>;\n}\n\nexport interface Global {\n  subs: SubController;\n  runtime?: Runtime;\n  config: RootConfig;\n  initComplete: boolean;\n  collecting: boolean;\n  runningAction: boolean | Action;\n  runningComputed: boolean | Computed;\n  runningWatcher: boolean | Watcher;\n  contextRef: ExpandableObject;\n  storage: any;\n  getDep: any;\n  // aliases\n  createForeignGroupRelation: any;\n  searchIndexes?: any;\n  dispatch: any;\n  getContext: any;\n  getInternalData: any;\n  uuid: any;\n  ingest?: any;\n  request?: any;\n  relations?: any;\n}\n\nexport interface Private {\n  global: Global;\n  runtime: Runtime;\n  collectionKeys: Array<string>;\n  collections?: { [key: string]: Collection };\n  events?: { [key: string]: Array<(payload?: any) => any> };\n}\n\nexport const enum JobType {\n  PUBLIC_DATA_MUTATION = 'PUBLIC_DATA_MUTATION',\n  INTERNAL_DATA_MUTATION = 'INTERNAL_DATA_MUTATION',\n  INDEX_UPDATE = 'INDEX_UPDATE',\n  COMPUTED_REGEN = 'COMPUTED_REGEN',\n  GROUP_UPDATE = 'GROUP_UPDATE',\n  DEEP_PUBLIC_DATA_MUTATION = 'DEEP_PUBLIC_DATA_MUTATION',\n  BULK_INTERNAL_DATA_MUTATION = 'BULK_INTERNAL_DATA_MUTATION',\n  DELETE_INTERNAL_DATA = 'DELETE_INTERNAL_DATA'\n}\n\nexport interface Job {\n  type: JobType;\n  collection: string;\n  property: string;\n  value?: any;\n  previousValue?: any;\n  dep?: Dep;\n  fromAction?: boolean | Action;\n}\n\nexport interface ComponentContainer {\n  instance: any;\n  uuid: string;\n  ready: boolean;\n}\n","import { log, objectLoop, log } from './helpers';\nimport { JobType, Job, Global } from './interfaces';\n\nexport default class Runtime {\n  public running: Boolean = false;\n  public updatingSubscribers: Boolean = false;\n\n  private ingestQueue: Array<Job> = [];\n  private completedJobs: Array<Job> = [];\n  private archivedJobs: Array<Job> = [];\n\n  // private collections: Object;\n  private config: Object;\n\n  constructor(private collections: Object, private global: Global) {\n    global.ingest = this.ingest.bind(this);\n    global.searchIndexes = this.searchIndexes.bind(this);\n    this.config = global.config;\n  }\n\n  public ingest(job: Job): void {\n    // if (\n    //   job.property === 'feed' &&\n    //   job.type === JobType.INDEX_UPDATE &&\n    //   job.value.length > 60\n    // )\n    //   debugger;\n\n    this.ingestQueue.push(job);\n    if (!this.running) {\n      this.findNextJob();\n    }\n  }\n\n  private findNextJob() {\n    this.running = true;\n    let next = this.ingestQueue.shift();\n\n    // non public data properties such as groups, computed and indexes will not have their dep, so get it.\n    if (!next.dep)\n      next.dep = this.collections[next.collection].public.getDep(next.property);\n\n    // execute the next task in the queue\n    this.performJob(next);\n  }\n\n  private performJob(job: Job): void {\n    switch (job.type) {\n      case JobType.PUBLIC_DATA_MUTATION:\n        this.performPublicDataUpdate(job);\n        this.collections[job.collection].runWatchers(job.property);\n        break;\n      case JobType.INTERNAL_DATA_MUTATION:\n        this.performInternalDataUpdate(job);\n        break;\n      case JobType.BULK_INTERNAL_DATA_MUTATION:\n        // this.performInternalDataUpdate(collection, property, value);\n        break;\n      case JobType.INDEX_UPDATE:\n        this.performIndexUpdate(job);\n        break;\n      case JobType.COMPUTED_REGEN:\n        this.performComputedOutput(job);\n        this.collections[job.collection].runWatchers(job.property.name);\n        break;\n      case JobType.GROUP_UPDATE:\n        this.performGroupRebuild(job);\n        this.collections[job.collection].runWatchers(job.property);\n        break;\n      case JobType.DELETE_INTERNAL_DATA:\n        this.performInternalDataDeletion(job);\n        break;\n      default:\n        break;\n    }\n\n    // unpack dependent computed\n    if (job.dep && job.dep.dependents.size > 0) {\n      // log(`Queueing ${dep.dependents.size} dependents`);\n      job.dep.dependents.forEach(computed => {\n        // get dep from public computed output\n        this.ingest({\n          type: JobType.COMPUTED_REGEN,\n          collection: computed.collection,\n          property: computed,\n          dep: this.collections[computed.collection].public.getDep(\n            computed.name\n          )\n        });\n      });\n    }\n    this.finished();\n  }\n\n  private finished(): void {\n    this.running = false;\n    if (this.completedJobs.length > 5000) return;\n\n    // If there's already more stuff in the queue, loop.\n    if (this.ingestQueue.length > 0) {\n      this.findNextJob();\n      return;\n    }\n\n    // Wait until callstack is empty to check if we should finalise this body of work\n    setTimeout(() => {\n      if (this.ingestQueue.length === 0) {\n        if (!this.updatingSubscribers) this.compileComponentUpdates();\n        this.cleanup();\n      } else {\n        // loop more!\n        this.findNextJob();\n      }\n    });\n  }\n\n  // Jobs runtime can perform\n  private performPublicDataUpdate(job: Job): void {\n    this.writeToPublicObject(job.collection, 'data', job.property, job.value);\n    this.completedJob(job);\n  }\n  private performInternalDataUpdate(job: Job): void {\n    job.previousValue = this.overwriteInternalData(\n      job.collection,\n      job.property,\n      job.value\n    );\n    // only look for indexes if we're not collecting data\n\n    if (this.global.collecting) {\n      // dependecies handled by master collection\n    } else {\n      //handle dependecies here\n    }\n\n    // find and ingest direct depenecies on data\n    this.global.relations.internalDataModified(job.collection, job.property);\n\n    this.findIndexesToUpdate(job.collection, job.property);\n    this.completedJob(job);\n  }\n\n  private performInternalDataDeletion(job: Job): void {\n    const c = this.collections[job.collection];\n    // preserve previous value\n    job.previousValue = { ...c.internalData[job.property] };\n    // delete data\n    delete c.internalData[job.property];\n    // find indexes affected by this data deletion\n    const indexesToUpdate = this.searchIndexes(job.collection, job.property);\n\n    // for each found index, perform index update\n    for (let i = 0; i < indexesToUpdate.length; i++) {\n      const indexName = indexesToUpdate[i];\n      const newIndex = [...c.indexes.object[indexName]].filter(\n        id => id !== job.property\n      );\n      this.ingest({\n        type: JobType.INDEX_UPDATE,\n        collection: c.name,\n        property: indexName,\n        value: newIndex,\n        dep: this.collections[job.collection].public.getDep(job.property)\n      });\n    }\n    this.completedJob(job);\n  }\n  private performIndexUpdate(job: Job): void {\n    // preserve old index\n    job.previousValue = this.collections[job.collection].indexes[job.property];\n    // Update Index\n    this.collections[job.collection].indexes.privateWrite(\n      job.property,\n      job.value\n    );\n    this.completedJob(job);\n\n    // Group must also be updated\n    this.ingest({\n      type: JobType.GROUP_UPDATE,\n      collection: job.collection,\n      property: job.property,\n      dep: this.collections[job.collection].public.getDep(job.property)\n    });\n  }\n  private performGroupRebuild(job: Job): void {\n    job.value = this.collections[job.collection].buildGroupFromIndex(\n      job.property\n    );\n    this.ingestForeignRelatedGroups(job.collection, job.property);\n    this.writeToPublicObject(job.collection, 'group', job.property, job.value);\n    this.completedJob(job);\n  }\n  public performComputedOutput(job: Job): void {\n    const computed =\n      typeof job.property === 'string'\n        ? this.collections[job.collection].computed[job.property]\n        : job.property;\n\n    job.value = computed.run();\n    // Commit Update\n    this.writeToPublicObject(\n      job.collection,\n      'computed',\n      computed.name,\n      job.value\n    );\n    this.completedJob(job);\n  }\n\n  // Handlers for committing updates\n  private writeToPublicObject(\n    collection: string,\n    type: string,\n    key: string,\n    value: any\n  ): void {\n    if (type === 'indexes') {\n      if (!this.collections[collection][type].object.hasOwnProperty(key))\n        return;\n      this.collections[collection][type].privateWrite(key, value);\n    } else {\n      if (!this.collections[collection].public.object.hasOwnProperty(key))\n        return;\n      this.collections[collection].public.privateWrite(key, value);\n    }\n  }\n\n  private completedJob(job: Job): void {\n    job.fromAction = this.global.runningAction;\n    if (this.global.initComplete) this.completedJobs.push(job);\n    this.persistData(job);\n  }\n\n  private compileComponentUpdates(): void {\n    if (!this.global.initComplete) return;\n    this.updatingSubscribers = true;\n    log('ALL JOBS COMPLETE', this.completedJobs);\n    log('Updating components...');\n\n    const componentsToUpdate = {};\n\n    const subscribe = (value, subscribers) => {\n      for (let i = 0; i < subscribers.length; i++) {\n        const uuid = subscribers[i].componentUUID;\n        const key = subscribers[i].key;\n        if (!componentsToUpdate[uuid]) {\n          componentsToUpdate[uuid] = {};\n          componentsToUpdate[uuid][key] = value;\n        } else {\n          componentsToUpdate[uuid][key] = value;\n        }\n      }\n    };\n\n    for (let i = 0; i < this.completedJobs.length; i++) {\n      const job = this.completedJobs[i];\n      if (job.dep) subscribe(job.value, job.dep.subscribers);\n    }\n\n    this.updateSubscribers(componentsToUpdate);\n    this.completedJobs = [];\n  }\n\n  private updateSubscribers(componentsToUpdate) {\n    const componentKeys = Object.keys(componentsToUpdate);\n    for (let i = 0; i < componentKeys.length; i++) {\n      const componentID = componentKeys[i];\n      const componentInstance = this.global.subs.componentStore[componentID];\n      if (!componentInstance || !componentInstance.instance) return;\n      const propertiesToUpdate = componentsToUpdate[componentID];\n      const dataKeys = Object.keys(propertiesToUpdate);\n      // Switch depending on framework\n      switch (this.global.config.framework) {\n        case 'vue':\n          dataKeys.forEach(property => {\n            const value = propertiesToUpdate[property];\n            componentInstance.instance.$set(\n              componentInstance.instance,\n              property,\n              value\n            );\n          });\n          break;\n        case 'react':\n          componentInstance.instance.setState(propertiesToUpdate);\n\n          break;\n\n        default:\n          break;\n      }\n    }\n  }\n\n  private persistData(job: Job): void {\n    if (job.type === JobType.INTERNAL_DATA_MUTATION) return;\n    if (this.collections[job.collection].persist.includes(job.property)) {\n      this.global.storage.set(job.collection, job.property, job.value);\n    }\n  }\n\n  private cleanup(): void {\n    setTimeout(() => {\n      this.updatingSubscribers = false;\n    });\n  }\n\n  private findIndexesToUpdate(collection, keys): void {\n    const foundIndexes = new Set();\n    const c = this.collections[collection];\n\n    if (!Array.isArray(keys)) keys = [keys];\n\n    for (let i = 0; i < keys.length; i++) {\n      const key = keys[i];\n      const searchIndexes = this.searchIndexes(collection, key);\n      searchIndexes.forEach(index => foundIndexes.add(index));\n    }\n\n    // foundIndexes.forEach((index: string) => {\n    //   this.ingest({\n    //     type: JobType.INDEX_UPDATE,\n    //     collection: c.name,\n    //     property: index,\n    //     dep: this.collections[c.name].indexes.getDep(index)\n    //   });\n    // });\n  }\n  // when groups are rebuilt, find other groups that are dependent on this group\n  // (defined using \"hasMany\" in the model) and ingest those groups into the queue.\n  private ingestForeignRelatedGroups(collection: string, groupName: string) {\n    let relations = this.collections[collection].foreignGroupRelations;\n    objectLoop(relations, (relationKey, relation) => {\n      if (relationKey === groupName)\n        this.ingest({\n          type: JobType.GROUP_UPDATE,\n          collection: relation.collection,\n          property: relation.groupToRegen,\n          dep: this.collections[relation.collection].public.getDep(\n            relation.groupToRegen\n          )\n        });\n    });\n  }\n\n  private searchIndexes(\n    collection: string,\n    primaryKey: string | number\n  ): Array<string> {\n    const c = this.collections[collection];\n    const keys = Object.keys(c.indexes.object);\n\n    let foundIndexes = [];\n    for (let i = 0; i < keys.length; i++) {\n      const indexName = keys[i];\n      if (c.indexes.object[indexName].includes(primaryKey))\n        foundIndexes.push(indexName);\n    }\n    return foundIndexes;\n  }\n\n  private overwriteInternalData(\n    collection: string,\n    primaryKey: string | number,\n    newData: any\n  ): object | boolean {\n    const currentData = Object.assign(\n      {},\n      this.collections[collection].internalData[primaryKey]\n    );\n    if (currentData[primaryKey]) {\n      // data already exists, merge objects and return previous object\n      const keys = Object.keys(newData);\n      for (let i = 0; i < keys.length; i++) {\n        const property = keys[i];\n        this.collections[collection].internalData[primaryKey][property] =\n          newData[property];\n      }\n      return currentData;\n    } else {\n      // data does not exist, write and return false\n      this.collections[collection].internalData[primaryKey] = newData;\n      return false;\n    }\n  }\n}\n","import { Global } from './interfaces';\n\nexport default class Dep {\n  public dependents: any = new Set();\n  public subscribers: Array<object> = [];\n\n  constructor(\n    private global: Global,\n    public name: string,\n    public rootProperty: string,\n    public propertyOnObject: string\n  ) {}\n\n  register() {\n    const subs = this.global.subs;\n\n    if (this.global.runningComputed) {\n      this.dependents.add(this.global.runningComputed);\n    }\n    if (subs.subscribingComponent) {\n      this.subscribeComponent();\n    }\n    if (subs.unsubscribingComponent) {\n      // this.subscribers.delete(this.global.subscribingComponent);\n    }\n  }\n\n  subscribeComponent() {\n    const subs = this.global.subs;\n\n    if (this.rootProperty && subs.skimmingDeepReactive) {\n      subs.prepareNext(this);\n      return;\n    }\n    if (this.rootProperty) {\n      subs.foundDeepReactive();\n      subs.prepareNext(this);\n      return;\n    }\n    if (!this.rootProperty && subs.skimmingDeepReactive) {\n      subs.exitDeepReactive();\n    }\n\n    this.subscribe();\n\n    subs.prepareNext(this);\n  }\n  subscribe() {\n    const subs = this.global.subs;\n    const keys = subs.subscribingComponent.keys;\n    const key = keys[subs.subscribingComponentKey];\n    const component = {\n      componentUUID: subs.subscribingComponent.componentUUID,\n      key: key\n    };\n    this.subscribers.push(component);\n  }\n}\n","import { protectedNames, arrayFunctions, isWatchableObject } from './helpers';\nimport Dep from './dep';\nimport { Global } from './interfaces';\n\ninterface Obj {\n  [key: string]: any;\n}\n\nexport default class Reactive {\n  public properties: Array<string>;\n  public object: Obj;\n  private dispatch: any;\n  private allowPrivateWrite: boolean = false;\n  private touching: boolean = false;\n  private touched: null | Dep;\n\n  constructor(\n    object: Obj = {},\n    private global: Global,\n    private collection: string,\n    public mutable: Array<string>,\n    public type: string\n  ) {\n    this.dispatch = this.global.dispatch;\n    this.properties = Object.keys(object);\n\n    this.object = this.reactiveObject(object);\n  }\n\n  reactiveObject(object: Obj, rootProperty?: string): object {\n    const self = this;\n    const objectKeys = Object.keys(object);\n\n    // Loop over all properties of the to-be reactive object\n    for (let i = 0; i < objectKeys.length; i++) {\n      const key = objectKeys[i];\n      const rootProperty = object.rootProperty;\n      const currentProperty = key;\n      let value = object[key];\n\n      // If property is an array, make it reactive\n      if (Array.isArray(value)) {\n        // value = this.reactiveArray(value, key);\n        // if property is an object, make it reactive also\n      } else if (isWatchableObject(value) && !protectedNames.includes(key)) {\n        // rootProperty should be the current key if first deep object\n        value = this.deepReactiveObject(\n          value,\n          rootProperty || key,\n          currentProperty\n        );\n      }\n\n      // Create an instance of the dependency tracker\n      const dep = new Dep(this.global, key, rootProperty, currentProperty);\n\n      Object.defineProperty(object, key, {\n        get: function pulseGetter() {\n          if (self.touching) {\n            self.touched = dep;\n            return;\n          }\n          dep.register();\n          return value;\n        },\n        set: function pulseSetter(newValue) {\n          // rootProperty indicates if the object is \"deep\".\n          if (rootProperty && self.mutable.includes(rootProperty)) {\n            // mutate locally\n            value = newValue;\n            // dispatch mutation for rootProperty\n            self.dispatch('mutation', {\n              collection: self.collection,\n              key: rootProperty,\n              value: self.object[rootProperty],\n              dep: dep\n            });\n          } else {\n            // if backdoor open or is protected name, allow direct mutation\n            if (self.allowPrivateWrite || protectedNames.includes(key))\n              return (value = newValue);\n\n            // if property is mutable dispatch update\n            if (self.mutable.includes(key)) {\n              self.dispatch('mutation', {\n                collection: self.collection,\n                key,\n                value: newValue,\n                dep: dep\n              });\n              // we did not apply the mutation since runtime will privatly\n              // write the result since we dispatched above\n            }\n          }\n        }\n      });\n    }\n    return object;\n  }\n\n  deepReactiveObject(value, rootProperty?: string, propertyOnObject?: string) {\n    let objectWithCustomPrototype = Object.create({\n      rootProperty,\n      propertyOnObject\n    });\n    // repopulate custom object with incoming values\n    const keys = Object.keys(value);\n    for (let i = 0; i < keys.length; i++) {\n      const property = keys[i];\n      objectWithCustomPrototype[property] = value[property];\n    }\n\n    this.allowPrivateWrite = true;\n    const obj = this.reactiveObject(objectWithCustomPrototype, rootProperty);\n    this.allowPrivateWrite = false;\n    return obj;\n  }\n\n  reactiveArray(array, key) {\n    const self = this;\n    const reactiveArray = array.slice();\n\n    for (let i = 0; i < arrayFunctions.length; i++) {\n      const func = arrayFunctions[i];\n      const original = Array.prototype[func];\n      Object.defineProperty(reactiveArray, func, {\n        value: function() {\n          const result = original.apply(this, arguments);\n          if (self.global.initComplete)\n            self.dispatch('mutation', {\n              collection: self.collection,\n              key,\n              value: result\n            });\n          return result;\n        }\n      });\n    }\n    return reactiveArray;\n  }\n\n  privateWrite(property, value) {\n    if (value === undefined) debugger;\n    this.allowPrivateWrite = true;\n    this.object[property] = value;\n    this.allowPrivateWrite = false;\n  }\n\n  privateGetValue(property) {\n    return this.object[property];\n  }\n\n  exists(property: string): boolean {\n    return !!this.object.hasOwnProperty(property);\n  }\n\n  getDep(property) {\n    this.touching = true;\n    const _ = this.object[property]; // eslint-disable-line no-unused-var\n    const dep = this.touched;\n    this.touching = false;\n    return dep;\n  }\n}\n\n// look for computed output access to determine dependencies\n// remove computed categories from public object on default config\n","import { uuid } from \"./helpers\";\nimport { Global } from \"./interfaces\";\n\nexport default class Action {\n  public executing: boolean = false;\n  public uuid: string;\n  public exec: () => {};\n\n  constructor(\n    private collection: string,\n    private global: Global,\n    public action: any,\n    public actionName: string\n  ) {\n    this.uuid = uuid();\n    this.prepare(action, global, this.global.contextRef.undo);\n  }\n\n  prepare(action, global, undo) {\n    const _this = this;\n\n    this.exec = function() {\n      const context = global.getContext(_this.collection);\n      context.undo = error => {\n        return undo(this.actionName, this.uuid, error);\n      };\n      global.runningAction = _this;\n\n      _this.executing = true;\n\n      const result = action.apply(\n        null,\n        [context].concat(Array.prototype.slice.call(arguments))\n      );\n\n      _this.executing = false;\n      global.runningAction = false;\n\n      return result;\n    };\n  }\n}\n","import { Global, JobType } from './interfaces';\n\nexport default class Computed {\n  public relatedToGroup: Array<any> = [];\n  public relatedToInternalData: Array<any> = [];\n\n  constructor(\n    private global: Global,\n    public collection: string,\n    public name: string,\n    private computedFunction: (context: object) => any\n  ) {}\n\n  public run() {\n    // cleanup before running\n\n    if (this.global.relations) this.global.relations.computedCleanup(this);\n\n    this.global.runningComputed = this;\n\n    let output = this.computedFunction(this.global.getContext(this.collection));\n\n    if (output === undefined || output === null) output = false;\n\n    this.global.runningComputed = false;\n\n    return output;\n  }\n\n  addRelationToGroup(collectionName: string, groupName: string): void {}\n  addRelationToInternalData(collectionName: string, primaryKey: string): void {\n    // const stringified = JSON.stringify({\n    //   collection: collectionName,\n    //   primaryKey\n    // });\n    // if (!this.relatedToInternalData.includes(stringified))\n    //   this.relatedToInternalData.push(stringified);\n  }\n}\n","import {\n  assert,\n  defineConfig,\n  validateNumber,\n  collectionFunctions,\n  objectLoop\n} from './helpers';\nimport Reactive from './reactive';\nimport Action from './action';\nimport Computed from './computed';\nimport {\n  Methods,\n  Keys,\n  CollectionObject,\n  CollectionConfig,\n  Global,\n  JobType,\n  ExpandableObject\n} from './interfaces';\n\nexport default class Collection {\n  private namespace: CollectionObject;\n  public public: Reactive;\n  public indexes: Reactive;\n  public config: CollectionConfig = {};\n  public keys: Keys = {};\n  public methods: Methods = {};\n\n  public actions: { [key: string]: Action } = {};\n  public computed: { [key: string]: Computed } = {};\n  public watchers: { [key: string]: any } = {};\n  public externalWatchers: { [key: string]: any } = {};\n  public persist: Array<string> = [];\n  public local: { [key: string]: any } = {};\n\n  public collectionSize: number = 0;\n  public primaryKey: string | number | boolean = false;\n\n  private internalData: object = {};\n\n  private dataRelations: { [key: string]: any } = {};\n  private groupRelations: { [key: string]: any } = {};\n  public foreignGroupRelations: { [key: string]: any } = {};\n\n  dispatch: void;\n\n  constructor(\n    public name: string,\n    protected global: Global,\n    root: CollectionObject\n  ) {\n    this.config = root.config;\n    this.dispatch = this.global.dispatch;\n\n    // legacy support (\"filters\" changed to \"computed\")\n    root.computed = { ...root.computed, ...root.filters };\n\n    root = this.prepareNamespace(root);\n\n    this.initReactive(root.data, root.groups);\n    this.initRoutes(root.routes);\n    this.initActions(root.actions);\n    this.initWatchers(root.watch);\n    this.initComputed(root.computed);\n\n    this.initModel(root.model);\n    this.initPersist(root.persist);\n  }\n\n  prepareNamespace(root: CollectionObject) {\n    // map collection methods\n    collectionFunctions.map(\n      func => (this.methods[func] = this[func].bind(this))\n    );\n\n    if (root.local) this.local = root.local;\n\n    // for each type set default and register keys\n    ['data', 'actions', 'computed', 'indexes', 'routes', 'watch'].forEach(\n      type => {\n        if (type !== 'indexes' && !root[type]) root[type] = {};\n        this.keys[type] =\n          type === 'indexes' ? root['groups'] || [] : Object.keys(root[type]);\n      }\n    );\n\n    // assign namespace, this is used by initReactive\n    this.namespace = Object.assign(\n      Object.create({ ...this.methods }), // bind methods to prototype\n      {\n        routes: {},\n        indexes: {},\n        actions: root.actions,\n        ...root.computed,\n        ...root.data,\n        ...this.normalizeGroups(root.groups)\n      }\n    );\n    return root;\n  }\n\n  // groups are defined by the user as an array of strings, this converts them into object/keys\n  normalizeGroups(groupsAsArray: any = []) {\n    const groups: object = {};\n    for (let i = 0; i < groupsAsArray.length; i++) {\n      const groupName = groupsAsArray[i];\n      groups[groupName] = [];\n    }\n    return groups;\n  }\n\n  runWatchers(property) {\n    const watcher = this.watchers[property];\n    if (watcher) watcher();\n    const externalWatchers = this.externalWatchers[property];\n    if (externalWatchers)\n      externalWatchers.forEach(func =>\n        typeof func === 'function' ? func() : false\n      );\n  }\n\n  initReactive(data: object = {}, groups: Array<any> | object = []) {\n    groups = this.normalizeGroups(groups);\n    // Make indexes reactive\n    this.indexes = new Reactive(\n      groups, // object\n      this.global, // global\n      this.name, // collection\n      this.keys.indexes, // mutable\n      'indexes' // type\n    );\n    this.namespace.indexes = this.indexes.object;\n\n    // Make entire public object Reactive\n    this.public = new Reactive(\n      this.namespace,\n      this.global,\n      this.name,\n      [...this.keys.data, ...this.keys.indexes],\n      'root'\n    );\n  }\n\n  initPersist(persist: Array<string>): void {\n    if (!Array.isArray(persist)) return;\n\n    for (let i = 0; i < persist.length; i++) {\n      const dataName = persist[i];\n\n      // TODO: validate\n\n      this.persist.push(dataName);\n      if (this.global.storage.isPromise) {\n        this.global.storage.get(this.name, dataName).then(data => {\n          if (data === undefined || data === null) return;\n          const job = {\n            type: JobType.PUBLIC_DATA_MUTATION,\n            value: data,\n            property: dataName,\n            collection: this.name,\n            dep: this.global.getDep(this.name, dataName)\n          };\n          this.global.ingest(job);\n        });\n      } else {\n        let data = this.global.storage.get(this.name, dataName);\n        if (data === undefined || data === null) continue;\n        this.public.privateWrite(dataName, data);\n      }\n    }\n  }\n\n  initActions(actions: object = {}) {\n    let actionKeys = Object.keys(actions);\n    for (let i = 0; i < actionKeys.length; i++) {\n      const action = actions[actionKeys[i]];\n      this.actions[actionKeys[i]] = new Action(\n        this.name,\n        this.global,\n        action,\n        actionKeys[i]\n      );\n\n      this.public.privateWrite(actionKeys[i], this.actions[actionKeys[i]].exec);\n    }\n  }\n\n  initWatchers(watchers: object = {}) {\n    let watcherKeys = Object.keys(watchers);\n    for (let i = 0; i < watcherKeys.length; i++) {\n      const watcher = watchers[watcherKeys[i]];\n      this.watchers[watcherKeys[i]] = () => {\n        this.global.runningWatcher = {\n          collection: this.name,\n          property: watcherKeys[i]\n        };\n        const watcherOutput = watcher(this.global.getContext(this.name));\n        this.global.runningWatcher = false;\n        return watcherOutput;\n      };\n    }\n    this.watchers._keys = watcherKeys;\n  }\n\n  initComputed(computed: object): void {\n    objectLoop(\n      computed,\n      (computedName: string, computedFunction: () => void) => {\n        this.computed[computedName] = new Computed(\n          this.global,\n          this.name,\n          computedName,\n          computedFunction\n        );\n        this.public.object[computedName] = [];\n      },\n      this.keys.computed\n    );\n  }\n\n  initRoutes(routes: ExpandableObject) {\n    const self = this;\n    const routeWrapped = routeName => {\n      return function() {\n        let requestObject = Object.assign({}, self.global.request);\n        requestObject.context = self.global.getContext();\n        return routes[routeName].apply(\n          null,\n          [requestObject].concat(Array.prototype.slice.call(arguments))\n        );\n      };\n    };\n    objectLoop(\n      routes,\n      routeName =>\n        (this.public.object.routes[routeName] = routeWrapped(routeName))\n    );\n  }\n\n  initModel(model = {}) {\n    Object.keys(model).forEach(property => {\n      Object.keys(model[property]).forEach(config => {\n        if (config === 'primaryKey') {\n          this.primaryKey = property;\n        } else if (config === 'type') {\n          // if (\n          //   [\n          //     'string',\n          //     'boolean',\n          //     'integer',\n          //     'number',\n          //     'array',\n          //     'object'\n          //   ].includes(model[property].type)\n          // ) {\n          //   // model types are properties of the model to type check & validate on collect\n          //   if (!this._modelTypes.includes(property)) {\n          //     this._modelTypes.push(property);\n          //   }\n          // }\n        } else if (config === 'parent' || config === 'hasOne') {\n          this.createDataRelation(\n            property,\n            model[property].parent || model[property].hasOne,\n            model[property].assignTo\n          );\n        } else if (config === 'has' || config === 'hasMany') {\n          this.createGroupRelation(\n            property,\n            model[property].has || model[property].hasMany,\n            model[property].assignTo\n          );\n        }\n      });\n    });\n  }\n\n  createDataRelation(primaryKeyName, fromCollectionName, assignTo) {\n    this.dataRelations[primaryKeyName] = {};\n    this.dataRelations[primaryKeyName].fromCollectionName = fromCollectionName;\n    if (assignTo) this.dataRelations[primaryKeyName].assignTo = assignTo;\n  }\n\n  createGroupRelation(primaryKeyName, fromCollectionName, assignTo) {\n    this.groupRelations[primaryKeyName] = {};\n    this.groupRelations[primaryKeyName].fromCollectionName = fromCollectionName;\n    if (assignTo) this.groupRelations[primaryKeyName].assignTo = assignTo;\n  }\n\n  buildGroupFromIndex(groupName: string): Array<number> {\n    const constructedArray = [];\n    let index = this.indexes.object[groupName];\n    for (let i = 0; i < index.length; i++) {\n      let id = index[i];\n      let data = Object.assign({}, this.internalData[id]);\n      if (!data) continue;\n      data = this.injectDataByRelation(data);\n      data = this.injectGroupByRelation(data, groupName);\n      constructedArray.push(data);\n    }\n    return constructedArray;\n  }\n\n  injectDataByRelation(data) {\n    // if (data.hasOwnProperty('liveStreamType')) debugger;\n    let relations = Object.keys(this.dataRelations);\n    if (relations.length > 0)\n      for (let i = 0; i < relations.length; i++) {\n        const relationKey = relations[i]; // the key on the data to look at\n        const rel = this.dataRelations[relationKey]; // an object with fromCollectionName & assignTo\n        const assignTo = rel.hasOwnProperty('assignTo')\n          ? rel.assignTo\n          : rel.fromCollectionName;\n\n        if (data.hasOwnProperty(relationKey)) {\n          let foreignData = this.global.getInternalData(\n            rel.fromCollectionName,\n            data[relationKey]\n          );\n          data[assignTo] = foreignData;\n        }\n      }\n    return data;\n  }\n\n  injectGroupByRelation(data, groupName) {\n    let groupRealtions = Object.keys(this.groupRelations);\n    if (groupRealtions.length > 0)\n      for (let i = 0; i < groupRealtions.length; i++) {\n        const relationKey = groupRealtions[i];\n        const rel = this.groupRelations[relationKey];\n\n        const assignTo = rel.hasOwnProperty('assignTo') ? rel.assignTo : false;\n\n        if (data.hasOwnProperty(relationKey)) {\n          const foreignData = this.global.contextRef[rel.fromCollectionName][\n            data[relationKey]\n          ];\n\n          if (foreignData) {\n            if (assignTo) data[assignTo] = foreignData;\n            else data[rel.fromCollectionName] = foreignData;\n          }\n\n          // register this relation on the foreign collection for reactive updates\n          this.global.createForeignGroupRelation(\n            rel.fromCollectionName,\n            data[relationKey],\n            this.name,\n            groupName\n          );\n        }\n      }\n    return data;\n  }\n\n  createGroups(group) {\n    if (group === undefined) group = [];\n    else if (!Array.isArray(group)) group = [group];\n\n    for (let i = 0; i < group.length; i++) {\n      const groupName = group[i];\n      if (!this.indexes.object[groupName]) {\n        this.indexes.object[groupName] = [];\n      }\n    }\n    return group;\n  }\n\n  // METHODS\n  collect(data, group?: string | Array<string>, config?: ExpandableObject) {\n    config = defineConfig(config, {\n      append: true\n    });\n    this.global.collecting = true;\n    // normalise data\n    if (!Array.isArray(data)) data = [data];\n\n    // if groups don't already exist, create them dynamically\n    const groups: Array<string> = this.createGroups(group);\n    // groups now contains just the groups directly modified by this collect\n\n    // preserve index previous values\n    const previousIndexValues: object = this.getPreviousIndexValues(groups);\n\n    const indexesToRegenOnceComplete = new Set();\n\n    // process data items\n    for (let i = 0; i < data.length; i++) {\n      const dataItem = data[i];\n      // process data item returns \"success\" as a boolean and affectedIndexes as an array\n      const processDataItem = this.processDataItem(dataItem, groups, config);\n      if (processDataItem.success) this.collectionSize++;\n      // ensure indexes modified by this data item are waiting to be ingested for regen\n      processDataItem.affectedIndexes.forEach(index =>\n        indexesToRegenOnceComplete.add(index)\n      );\n    }\n\n    indexesToRegenOnceComplete.forEach(index => {\n      this.global.ingest({\n        type: JobType.INDEX_UPDATE,\n        collection: this.name,\n        property: index,\n        value: this.indexes.object[index],\n        previousValue: previousIndexValues[index]\n      });\n    });\n\n    this.global.collecting = false;\n  }\n\n  processDataItem(dataItem: object, groups: Array<string> = [], config) {\n    if (!this.primaryKey) this.findPrimaryKey(dataItem);\n\n    const key = dataItem[this.primaryKey as number | string];\n\n    // find affected indexes\n    let affectedIndexes = [...groups];\n\n    this.global\n      .searchIndexes(this.name, key)\n      .map(\n        index => !affectedIndexes.includes(index) && affectedIndexes.push(index)\n      );\n\n    // validate against model\n\n    // ingest the data\n    this.global.ingest({\n      type: JobType.INTERNAL_DATA_MUTATION,\n      collection: this.name,\n      property: key,\n      value: dataItem\n    });\n\n    // add the data to group indexes\n    for (let i = 0; i < groups.length; i++) {\n      const groupName = groups[i];\n      let index = [...this.indexes.object[groupName]];\n      // remove key if already present in index\n      index = index.filter(k => k !== key);\n      if (config.append) index.push(key);\n      else index.unshift(key);\n      this.indexes.privateWrite(groupName, index);\n    }\n    return { success: true, affectedIndexes };\n  }\n\n  getPreviousIndexValues(groups) {\n    const returnData = {};\n    for (let i = 0; i < groups; i++) {\n      const groupName = groups[i];\n      returnData[groupName] = this.indexes.object[groupName];\n    }\n    return returnData;\n  }\n\n  findPrimaryKey(dataItem) {\n    if (dataItem.hasOwnProperty('id')) this.primaryKey = 'id';\n    else if (dataItem.hasOwnProperty('_id')) this.primaryKey = '_id';\n    else if (dataItem.hasOwnProperty('key')) this.primaryKey = 'key';\n    if (this.primaryKey) return true;\n    else return assert(warn => warn.NO_PRIMARY_KEY);\n  }\n\n  replaceIndex(indexName: string, newIndex: Array<string | number>) {\n    if (!Array.isArray(newIndex) || typeof indexName !== 'string')\n      return assert(warn => warn.INVALID_PARAMETER, 'replaceIndex');\n    this.global.ingest({\n      type: JobType.INDEX_UPDATE,\n      collection: this.name,\n      property: indexName,\n      value: newIndex\n    });\n  }\n\n  findById(id) {\n    // if (!this.internalData.hasOwnProperty(id))\n    //   return assert(warn => warn.INTERNAL_DATA_NOT_FOUND, 'findById');\n\n    if (this.global.runningComputed) {\n      let computed = this.global.runningComputed as Computed;\n      this.global.relations.createInternalDataRelation(this.name, id, computed);\n    }\n    return this.internalData[id];\n  }\n\n  // action functions\n  undo() {}\n  throttle() {}\n\n  // group functions\n  move(\n    ids: number | Array<string | number>,\n    sourceIndexName: string,\n    destIndexName?: string,\n    method: 'push' | 'unshift' = 'push'\n  ) {\n    // validation\n    if (!this.indexes.exists(sourceIndexName))\n      return assert(warn => warn.INDEX_NOT_FOUND, 'move');\n\n    if (destIndexName && !this.indexes.exists(destIndexName))\n      return assert(warn => warn.INDEX_NOT_FOUND, 'move');\n\n    if (!Array.isArray(ids)) ids = [ids];\n\n    let sourceIndex = this.indexes.privateGetValue(sourceIndexName);\n    for (let i = 0; i < ids.length; i++) sourceIndex.map(id => id !== ids[i]);\n\n    this.global.ingest({\n      type: JobType.INDEX_UPDATE,\n      collection: this.name,\n      property: sourceIndexName,\n      value: sourceIndex\n    });\n\n    if (destIndexName) {\n      let destIndex = this.indexes.privateGetValue(destIndexName);\n      for (let i = 0; i < ids.length; i++) destIndex[method](ids[i]);\n\n      this.global.ingest({\n        type: JobType.INDEX_UPDATE,\n        collection: this.name,\n        property: destIndexName,\n        value: destIndex\n      });\n    }\n  }\n\n  put(\n    ids: number | Array<string | number>,\n    destIndexName: string,\n    method: 'push' | 'unshift' = 'push'\n  ) {\n    // validation\n    if (!this.indexes.exists(destIndexName))\n      return assert(warn => warn.INDEX_NOT_FOUND, 'put');\n\n    if (!Array.isArray(ids)) ids = [ids];\n\n    let destIndex = this.indexes.privateGetValue(destIndexName);\n    for (let i = 0; i < ids.length; i++) destIndex[method](ids[i]);\n\n    this.global.ingest({\n      type: JobType.INDEX_UPDATE,\n      collection: this.name,\n      property: destIndexName,\n      value: destIndex\n    });\n  }\n\n  getGroup(property) {\n    if (!this.indexes.exists(property))\n      return assert(warn => warn.INDEX_NOT_FOUND, 'getGroup') || [];\n\n    if (this.global.runningComputed) {\n      let computed = this.global.runningComputed as Computed;\n      computed.addRelationToGroup(this.name, property);\n    }\n    return this.buildGroupFromIndex(property) || [];\n  }\n  newGroup(groupName: string, indexValue?: Array<string | number>) {\n    if (this.indexes.object.hasOwnProperty(groupName))\n      return assert(warn => warn.GROUP_ALREADY_EXISTS, 'newGroup');\n\n    this.global.ingest({\n      type: JobType.INDEX_UPDATE,\n      collection: this.name,\n      property: groupName,\n      value: indexValue\n    });\n  }\n  deleteGroup(groupName: string) {\n    this.global.ingest({\n      type: JobType.INDEX_UPDATE,\n      collection: this.name,\n      property: groupName,\n      value: []\n    });\n  }\n  removeFromGroup(\n    groupName: string,\n    itemsToRemove: number | string | Array<number | string>\n  ) {\n    if (!this.indexes.exists(groupName))\n      return assert(warn => warn.INDEX_NOT_FOUND, 'removeFromGroup');\n\n    if (!Array.isArray(itemsToRemove)) itemsToRemove = [itemsToRemove];\n\n    const index = this.indexes.privateGetValue(groupName);\n\n    const newIndex = index.filter(\n      id => !(itemsToRemove as Array<number | string>).includes(id)\n    );\n\n    this.global.ingest({\n      type: JobType.INDEX_UPDATE,\n      collection: this.name,\n      property: groupName,\n      value: newIndex\n    });\n  }\n\n  // internal data functions\n  update(primaryKey: string | number, newObject: { [key: string]: any }) {\n    if (!this.internalData.hasOwnProperty(primaryKey))\n      return assert(warn => warn.INTERNAL_DATA_NOT_FOUND, 'update');\n\n    const newObjectKeys = Object.keys(newObject);\n    const currentData = Object.assign({}, this.internalData[primaryKey]);\n\n    for (let i = 0; i < newObjectKeys.length; i++) {\n      const key = newObjectKeys[i];\n      currentData[key] = newObject[key];\n    }\n    this.global.ingest({\n      type: JobType.INTERNAL_DATA_MUTATION,\n      collection: this.name,\n      property: primaryKey,\n      value: currentData\n    });\n  }\n  increment(\n    primaryKey: string | number,\n    property: string,\n    amount: number,\n    decrement?: boolean\n  ) {\n    if (!this.internalData.hasOwnProperty(primaryKey))\n      return assert(\n        warn => warn.INTERNAL_DATA_NOT_FOUND,\n        decrement ? 'decrement' : 'increment'\n      );\n\n    const currentData = Object.assign({}, this.internalData[primaryKey]);\n\n    if (!validateNumber(amount, currentData[property]))\n      return assert(\n        warn => warn.PROPERTY_NOT_A_NUMBER,\n        decrement ? 'decrement' : 'increment'\n      );\n\n    if (decrement) currentData[property] -= amount;\n    else currentData[property] += amount;\n\n    this.global.ingest({\n      type: JobType.INTERNAL_DATA_MUTATION,\n      collection: this.name,\n      property: primaryKey,\n      value: currentData\n    });\n  }\n  decrement(primaryKey: string | number, property: string, amount: number) {\n    this.increment(primaryKey, property, amount, true);\n  }\n\n  delete(primaryKeys: string | number | Array<string | number>) {\n    if (!Array.isArray(primaryKeys)) primaryKeys = [primaryKeys];\n    for (let i = 0; i < primaryKeys.length; i++) {\n      const primaryKey = primaryKeys[i];\n      this.global.ingest({\n        type: JobType.DELETE_INTERNAL_DATA,\n        collection: this.name,\n        property: primaryKey\n      });\n    }\n  }\n\n  // remove all dynamic indexes, empty all indexes, delete all internal data\n  purge() {}\n\n  // external functions\n  watch(property, callback) {\n    if (!this.externalWatchers[property])\n      this.externalWatchers[property] = [callback];\n    else this.externalWatchers[property].push(callback);\n  }\n\n  // deprecate\n  // added removeFromGroup to be more specific, params got switched around, keeping this for backwards compatibility\n  remove(itemsToRemove, groupName) {\n    return this.removeFromGroup(groupName, itemsToRemove);\n  }\n}\n","// This file handles external components subscribing to pulse.\n// It also handles subscribing mapData properties to collections\n\nimport { uuid } from './helpers';\nimport { Global, ComponentContainer } from './interfaces';\nimport Dep from './dep';\n\ninterface SubscribingComponentObject {\n  componentUUID: string;\n  keys: Array<string>;\n}\n\nexport default class SubController {\n  private uuid: any = uuid;\n  private subscribingComponentKey: number = 0;\n  private subscribingComponent: boolean | SubscribingComponentObject = false;\n  private unsubscribingComponent: boolean = false;\n  private skimmingDeepReactive: boolean = false;\n  private lastAccessedDep: null | Dep = null;\n\n  public componentStore: { [key: string]: ComponentContainer } = {};\n\n  constructor(private getContext: any) {}\n\n  registerComponent(instance, config) {\n    let uuid = instance.__pulseUniqueIdentifier;\n    if (!uuid) {\n      // generate UUID\n      uuid = this.uuid();\n      // inject uuid into component instance\n      const componentContainer = {\n        instance: instance,\n        uuid,\n        ready: config.waitForMount ? false : true\n      };\n      instance.__pulseUniqueIdentifier = uuid;\n\n      this.componentStore[uuid] = componentContainer;\n    } else {\n      this.mount(instance);\n    }\n    return uuid;\n  }\n\n  mount(instance) {\n    let component = this.componentStore[instance.__pulseUniqueIdentifier];\n\n    if (component) {\n      component.instance = instance;\n      component.ready = true;\n    }\n  }\n\n  unmount(instance) {\n    const uuid = instance.__pulseUniqueIdentifier;\n    if (!uuid) return;\n\n    const componentContainer = this.componentStore[\n      instance.__pulseUniqueIdentifier\n    ];\n\n    // delete refrence to this component from store\n    delete this.componentStore[instance.__pulseUniqueIdentifier];\n  }\n\n  subscribePropertiesToComponents(properties, componentUUID) {\n    // provisionally get keys of mapped data\n    const provision = properties(this.getContext());\n    const keys = Object.keys(provision);\n\n    // mapData has a user defined local key, we need to include that in the subscription so we know what to update on the component later.\n    this.subscribingComponentKey = 0;\n    this.subscribingComponent = {\n      componentUUID,\n      keys\n    };\n    const returnToComponent = properties(this.getContext());\n    this.subscribingComponent = false;\n    this.subscribingComponentKey = 0;\n    return returnToComponent;\n  }\n  prepareNext(dep) {\n    this.lastAccessedDep = dep;\n    if (!this.skimmingDeepReactive) this.subscribingComponentKey++;\n  }\n  foundDeepReactive() {\n    this.skimmingDeepReactive = true;\n    // undo changes\n    this.lastAccessedDep.subscribers.pop();\n    this.subscribingComponentKey--;\n  }\n  exitDeepReactive() {\n    this.skimmingDeepReactive = false;\n    //redo changes\n    this.lastAccessedDep.subscribe();\n    this.subscribingComponentKey++;\n  }\n}\n","interface StorageMethods {\n  async?: boolean;\n  get?: any;\n  set?: any;\n  remove?: any;\n}\n\nexport default class Storage {\n  private isPromise: boolean = false;\n  private storageReady: boolean = false;\n  private storageType: 'localStorage' | 'custom' = 'localStorage';\n  constructor(private storageMethods: StorageMethods = {}) {\n    if (storageMethods.async) this.isPromise = true;\n    if (this.localStorageAvaliable() && this.storageType === 'localStorage') {\n      this.storageReady = true;\n      storageMethods.get = localStorage.getItem.bind(localStorage);\n      storageMethods.set = localStorage.setItem.bind(localStorage);\n      storageMethods.remove = localStorage.removeItem.bind(localStorage);\n    } else {\n      this.storageType = 'custom';\n\n      if (\n        this.check(storageMethods.get) &&\n        this.check(storageMethods.set) &&\n        this.check(storageMethods.remove)\n      ) {\n        this.storageReady = true;\n      } else {\n        this.storageReady = false;\n        // bad\n      }\n    }\n  }\n\n  public get(collection, key) {\n    if (!this.storageReady) return;\n\n    if (this.isPromise) {\n      return new Promise((resolve, reject) => {\n        this.storageMethods\n          .get(this.getKey(collection, key))\n          .then(res => {\n            // if result is not JSON for some reason, return it.\n            if (typeof res !== 'string') return resolve(res);\n\n            resolve(JSON.parse(res));\n          })\n          .catch(reject);\n      });\n    } else {\n      return JSON.parse(this.storageMethods.get(this.getKey(collection, key)));\n    }\n  }\n\n  public set(collection, key, value) {\n    if (!this.storageReady) return;\n    this.storageMethods.set(\n      this.getKey(collection, key),\n      JSON.stringify(value)\n    );\n  }\n\n  public remove(collection, key) {\n    if (!this.storageReady) return;\n    this.storageMethods.remove(this.getKey(collection, key));\n  }\n\n  private getKey(collection, key) {\n    return `_${collection}_${key}`;\n  }\n\n  private check(func) {\n    return typeof func === 'function';\n  }\n\n  private localStorageAvaliable() {\n    try {\n      localStorage.setItem('_', '_');\n      localStorage.removeItem('_');\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n}\n","import Collection from '../collection';\nimport { Global, ExpandableObject, RequestConfig } from '../interfaces';\n\ntype Method = 'get' | 'put' | 'post' | 'patch' | 'delete';\n\nexport default class Request extends Collection {\n  private timeout: number;\n  private options: ExpandableObject;\n  private saveHistory: boolean;\n\n  private requestIntercept: (\n    context: ExpandableObject,\n    options: ExpandableObject\n  ) => void;\n  private responseIntercept: (\n    context: ExpandableObject,\n    response: ExpandableObject\n  ) => void;\n\n  constructor(global: Global, requestConfig: RequestConfig) {\n    // Before we invoke the parent class, we define some defaults\n    let groups = [];\n    let persist = ['baseURL'];\n    let data = {\n      baseURL: requestConfig.baseURL || '',\n      mode: 'cors',\n      credentials: 'same-origin',\n      headers: {\n        Accept: 'application/json'\n      }\n    };\n\n    if (requestConfig.headers)\n      Object.keys(requestConfig.headers).forEach(header => {\n        data.headers[header] = requestConfig.headers[header];\n      });\n\n    if (requestConfig.credentials) data.credentials = requestConfig.credentials;\n    if (requestConfig.mode) data.mode = requestConfig.mode;\n\n    super('request', global, { groups, data, persist });\n\n    this.requestIntercept = requestConfig.requestIntercept;\n    this.responseIntercept = requestConfig.responseIntercept;\n    this.timeout = requestConfig.timeout;\n    this.saveHistory =\n      typeof requestConfig.saveHistory === 'undefined' ? true : false;\n\n    this.global.request = {\n      get: this.get.bind(this),\n      post: this.post.bind(this),\n      put: this._put.bind(this),\n      patch: this.patch.bind(this),\n      delete: this.delete.bind(this),\n      queryify: this.queryify.bind(this)\n    };\n  }\n\n  get(url: string, headers?: ExpandableObject) {\n    return this.send(url, 'get', {}, headers);\n  }\n\n  post(url: string, body?: ExpandableObject, headers?: ExpandableObject) {\n    return this.send(url, 'post', body, headers);\n  }\n\n  _put(url: string, body?: ExpandableObject, headers?: ExpandableObject) {\n    return this.send(url, 'put', body, headers);\n  }\n\n  patch(url: string, body?: ExpandableObject, headers?: ExpandableObject) {\n    return this.send(url, 'patch', body, headers);\n  }\n\n  delete(url: string, body?: ExpandableObject, headers?: ExpandableObject) {\n    return this.send(url, 'delete', body, headers);\n  }\n\n  async send(\n    url: string,\n    method: Method,\n    body: ExpandableObject | string = {},\n    headers: ExpandableObject\n  ) {\n    const requestHeaders = Object.assign({}, this.public.object.headers);\n\n    if (headers)\n      Object.keys(headers).forEach(header => {\n        requestHeaders[header] = headers[header];\n      });\n\n    // If method is not get set application type\n    if (method !== 'get' && requestHeaders['Content-Type'] === undefined)\n      requestHeaders['Content-Type'] = 'application/json';\n\n    let fullURL;\n\n    if (url.startsWith('http')) fullURL = url;\n    else fullURL = `${this.public.object.baseURL}/${url}`;\n\n    // Stringify body\n    body = JSON.stringify(body);\n\n    // Build options\n    this.options = {};\n    this.options.credentials = this.public.object.credentials;\n    this.options.mode = this.public.object.mode;\n\n    // Build final fetch options object\n    const options = Object.assign(\n      {\n        headers: requestHeaders,\n        method: method.toUpperCase(),\n        body: method === 'get' ? null : body\n      },\n      this.options\n    );\n\n    if (this.requestIntercept)\n      this.requestIntercept(this.global.getContext(), options);\n\n    let response: any;\n\n    if (this.timeout) {\n      response = await Promise.race([\n        fetch(fullURL, options),\n        new Promise((resolve, reject) =>\n          setTimeout(() => reject('timeout'), this.timeout)\n        )\n      ]);\n    } else {\n      response = await fetch(fullURL, options);\n    }\n\n    const contentType = response.headers.get('content-type');\n\n    // extract body\n    if (contentType && contentType.indexOf('application/json') !== -1) {\n      body = await response.json();\n    } else {\n      body = await response.text();\n    }\n\n    // history\n    if (!this.saveHistory)\n      this.collect({\n        id: Date.now(),\n        status: response.status,\n        timestamp: new Date(),\n        response: body\n      });\n\n    // inject headers into prototype\n    let final;\n\n    // If reponse body is an object, create a custom object with response function in prototype, so headers and the full response data can be accessed outside of this class\n    if (!Array.isArray(body) && typeof body === 'object') {\n      final = Object.create({\n        response: () => {\n          return response;\n        }\n      });\n      const keys = Object.keys(body);\n      for (let i = 0; i < keys.length; i++) {\n        const property = keys[i];\n        final[property] = body[property];\n      }\n      // if the body is not an object, we can not inject a prototype, so just return the rew body\n    } else {\n      final = body;\n    }\n    // intercept response\n    if (this.responseIntercept) {\n      response.data = body;\n      this.responseIntercept(this.global.getContext(), response);\n    }\n\n    // reject if bad response status\n    if (response.ok || response.redirected) return final;\n\n    // resolve response\n    throw final;\n  }\n\n  // Adapted from: https://github.com/Gozala/querystring/blob/master/encode.js\n  queryify(obj) {\n    const stringifyPrimitive = function(value) {\n      switch (typeof value) {\n        case 'string':\n          return value;\n\n        case 'boolean':\n          return value ? 'true' : 'false';\n\n        case 'number':\n          return isFinite(value) ? value : '';\n\n        default:\n          return '';\n      }\n    };\n    // validate input\n    if (typeof obj != 'object') return;\n\n    return Object.keys(obj)\n      .map(key => {\n        const encodedKey = encodeURIComponent(stringifyPrimitive(key)) + '=';\n        // if value is an array, encode with same key as parent\n        if (Array.isArray(obj[key]))\n          return obj[key]\n            .map(value => {\n              return encodedKey + encodeURIComponent(stringifyPrimitive(value));\n            })\n            .join('&');\n        // join encoded key with value\n        return encodedKey + encodeURIComponent(stringifyPrimitive(obj[key]));\n      })\n      .join('&');\n  }\n}\n","import Collection from '../collection';\nimport { Global, RootCollectionObject } from '../interfaces';\n\nexport default class Request extends Collection {\n  constructor(global: Global, root: RootCollectionObject = {}) {\n    root = Object.assign({}, root);\n\n    delete root.collections;\n    delete root.request;\n\n    if (!root.data) root.data = {};\n    if (!root.persist) root.persist = [];\n\n    root.data['isAuthenticated'] = false;\n    root.data['appReady'] = false;\n\n    root.persist.push('isAuthenticated');\n\n    super('base', global, root);\n  }\n}\n","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","var defineProperty = require(\"./defineProperty\");\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      defineProperty(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\n\nmodule.exports = _objectSpread;","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","function _typeof2(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof2 = function _typeof2(obj) { return typeof obj; }; } else { _typeof2 = function _typeof2(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof2(obj); }\n\nfunction _typeof(obj) {\n  if (typeof Symbol === \"function\" && _typeof2(Symbol.iterator) === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return _typeof2(obj);\n    };\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : _typeof2(obj);\n    };\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;","function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nmodule.exports = _assertThisInitialized;","var _typeof = require(\"../helpers/typeof\");\n\nvar assertThisInitialized = require(\"./assertThisInitialized\");\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}\n\nmodule.exports = _possibleConstructorReturn;","function _getPrototypeOf(o) {\n  module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nmodule.exports = _getPrototypeOf;","function _setPrototypeOf(o, p) {\n  module.exports = _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nmodule.exports = _setPrototypeOf;","var setPrototypeOf = require(\"./setPrototypeOf\");\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}\n\nmodule.exports = _inherits;","function _extends() {\n  _extends =\n    Object.assign ||\n    function(target) {\n      for (var i = 1; i < arguments.length; i++) {\n        var source = arguments[i];\n        for (var key in source) {\n          if (Object.prototype.hasOwnProperty.call(source, key)) {\n            target[key] = source[key];\n          }\n        }\n      }\n      return target;\n    };\n  return _extends.apply(this, arguments);\n}\n\nexport default function withPulse(pulse, React, ReactComponent, selectData) {\n  return class extends React.Component {\n    constructor(props) {\n      super(props);\n      this.state = {\n        ...pulse.mapData(\n          selectData,\n          this,\n          {\n            waitForMount:\n              pulse._private.global.config.waitForMount === false ? false : true\n          },\n          pulse\n        )\n      };\n    }\n    componentDidMount() {\n      if (pulse._private.global.config.waitForMount) pulse.mount(this);\n    }\n    componentWillUnmount() {\n      if (pulse._private.global.config.autoUnmount) pulse.unmount(this);\n    }\n    render() {\n      return React.createElement(\n        ReactComponent,\n        _extends(\n          {\n            pulse: this.state\n          },\n          this.props\n        )\n      );\n    }\n  };\n}\n","// This file tracks and handles miscellaneous relationships between:\n// - Data & Computed (findById())\n// - Groups to sister collection groups (hasMany)\n\nimport { Global, JobType } from './interfaces';\nimport Computed from './computed';\n\nexport default class RelationController {\n  private groupRelations: { [key: string]: Array<string> } = {};\n  private dataRelationsToComputed: { [key: string]: Array<Computed> } = {};\n  constructor(\n    // collections reference\n    private global: Global\n  ) {}\n\n  // Called inside \"findById\" and potentially other functions that allow data to be related to Computed properties\n  public createInternalDataRelation(\n    collectionName: string,\n    primaryKey: string | number,\n    computedInstance: Computed\n  ) {\n    const key = `${collectionName}/${primaryKey}`;\n    let relations = this.dataRelationsToComputed[key];\n    if (Array.isArray(relations)) relations.push(computedInstance);\n    else this.dataRelationsToComputed[key] = [computedInstance];\n  }\n\n  // Called when internal data has been modified. It checks to see if any computed relations exist for that data.\n  // If found, ingest the computed instance into the job queue.\n  public internalDataModified(collection, primaryKey) {\n    const key = `${collection}/${primaryKey}`;\n    if (this.dataRelationsToComputed[key]) {\n      this.dataRelationsToComputed[key].forEach(computedInstance => {\n        // ingest instance\n        this.global.ingest({\n          type: JobType.COMPUTED_REGEN,\n          collection: collection,\n          property: computedInstance,\n          dep: this.global.getDep(\n            computedInstance.collection,\n            computedInstance.name\n          )\n        });\n      });\n    }\n  }\n  // Computed functions that include \"findById\" will need to cleanup their relations since output of findById (the data to relate to) has probably changed)\n  public computedCleanup(computed) {\n    let relationKeys = Object.keys(this.dataRelationsToComputed);\n    for (let i = 0; i < relationKeys.length; i++) {\n      let relationKey = relationKeys[i];\n      let relations = this.dataRelationsToComputed[relationKey];\n      relations.forEach((computedInstance, index) => {\n        if (computedInstance === computed) {\n          relations.length > 1\n            ? relations.splice(index, 1)\n            : delete this.dataRelationsToComputed[relationKey];\n        }\n      });\n    }\n  }\n}\n","import Runtime from './runtime';\nimport Collection from './collection';\nimport SubController from './subController';\nimport Storage from './storage';\nimport Request from './collections/request';\nimport Base from './collections/base';\nimport withPulse from './wrappers/ReactWithPulse';\nimport { uuid, normalizeMap, log, defineConfig } from './helpers';\nimport { Private, RootCollectionObject, JobType } from './interfaces';\nimport RelationController from './relationController';\n\nexport default class Library {\n  _private: Private;\n  [key: string]: any;\n  constructor(root: RootCollectionObject) {\n    // Private object contains all internal Pulse data\n    this._private = {\n      runtime: null,\n      events: {},\n      collections: {},\n      collectionKeys: [],\n      // global is passed in to all classes, must not contain cyclic references\n      global: {\n        config: this.prepareConfig(root.config),\n        // State\n        initComplete: false,\n        runningAction: false,\n        runningWatcher: false,\n        runningComputed: false,\n        collecting: false,\n        contextRef: {},\n        // Instances\n        subs: new SubController(this.getContext.bind(this)),\n        relations: null,\n        storage: null,\n        // Function aliases\n        dispatch: this.dispatch.bind(this),\n        getInternalData: this.getInternalData.bind(this),\n        getContext: this.getContext.bind(this),\n        createForeignGroupRelation: this.createForeignGroupRelation.bind(this),\n        getDep: this.getDep.bind(this),\n        uuid\n      }\n    };\n\n    // Bind static objects to instance (utils and services eventually should be initialized)\n    ['utils', 'services', 'staticData'].forEach(type => {\n      if (root[type]) this[type] = root[type];\n    });\n\n    // Create storage instance\n    this._private.global.storage = new Storage(root.storage);\n\n    // Create relation controller instance\n    this._private.global.relations = new RelationController(\n      this._private.global\n    );\n\n    // Prepare\n    this.initCollections(root);\n    this.initRuntime();\n\n    // Finalize\n    this.bindCollectionPublicData();\n    this.runAllComputed();\n\n    this.initComplete();\n  }\n\n  initCollections(root: RootCollectionObject) {\n    this._private.collectionKeys = Object.keys(root.collections);\n\n    for (let i = 0; i < this._private.collectionKeys.length; i++) {\n      // Create collection instance\n      this._private.collections[\n        this._private.collectionKeys[i]\n      ] = new Collection(\n        this._private.collectionKeys[i], // name\n        this._private.global, // global\n        root.collections[this._private.collectionKeys[i]] // collection config\n      );\n    }\n\n    // Create request class\n    if (this._private.global.config.enableRequest !== false)\n      this._private.collectionKeys.push('request');\n    this._private.collections['request'] = new Request(\n      this._private.global,\n      root.request || {}\n    );\n\n    // Create base class\n    if (this._private.global.config.enableBase !== false) {\n      this._private.collectionKeys.push('base');\n      this._private.collections['base'] = new Base(this._private.global, root);\n    }\n  }\n\n  initRuntime() {\n    this._private.runtime = new Runtime(\n      this._private.collections,\n      this._private.global\n    );\n  }\n\n  private bindCollectionPublicData(): void {\n    for (let i = 0; i < this._private.collectionKeys.length; i++) {\n      const collection = this._private.collections[\n        this._private.collectionKeys[i]\n      ];\n      this._private.global.contextRef[this._private.collectionKeys[i]] =\n        collection.public.object;\n      this[this._private.collectionKeys[i]] = collection.public.object;\n    }\n  }\n\n  runAllComputed() {\n    for (let i = 0; i < this._private.collectionKeys.length; i++) {\n      const collection = this._private.collections[\n        this._private.collectionKeys[i]\n      ];\n\n      const computedKeys = collection.keys.computed;\n      for (let i = 0; i < computedKeys.length; i++) {\n        const computedName = computedKeys[i];\n        this._private.runtime.performComputedOutput({\n          collection: collection.name,\n          property: computedName,\n          type: JobType.COMPUTED_REGEN\n        });\n        collection.runWatchers(computedName);\n      }\n    }\n  }\n\n  initComplete() {\n    this._private.global.initComplete = true;\n    log('INIT COMPLETE', Object.assign({}, this));\n    if (!this._private.global.config.ssr) {\n      try {\n        window._pulse = this;\n      } catch (e) {}\n    }\n\n    console.log(this);\n  }\n\n  public wrapped(ReactComponent, mapData) {\n    const config = this._private.global.config;\n    if (config.framework === 'react' && config.frameworkConstructor) {\n      return withPulse(\n        this,\n        config.frameworkConstructor,\n        ReactComponent,\n        mapData\n      );\n    } else return false;\n  }\n\n  private prepareConfig(config) {\n    // defaults\n    config = defineConfig(config, {\n      framework: null,\n      waitForMount: false,\n      autoUnmount: false\n    });\n\n    // detect if framework passed in is a React constructor\n    if (\n      config.framework &&\n      config.framework.hasOwnProperty(\n        '__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED'\n      )\n    ) {\n      config.frameworkConstructor = config.framework;\n      config.framework = 'react';\n    }\n\n    if (config.framework === 'react') {\n      if (config.waitForMount != false) config.waitForMount = true;\n      if (config.autoUnmount != false) config.autoUnmount = true;\n    }\n\n    return config;\n  }\n\n  getInternalData(collection, primaryKey) {\n    return this._private.collections[collection].findById(primaryKey);\n  }\n\n  getDep(collection, name) {\n    return this._private.collections[collection].public.getDep(name);\n  }\n\n  dispatch(type: string, payload) {\n    switch (type) {\n      case 'mutation':\n        this._private.runtime.ingest({\n          type: JobType.PUBLIC_DATA_MUTATION,\n          collection: payload.collection,\n          property: payload.key,\n          value: payload.value,\n          dep: payload.dep\n        });\n        break;\n\n      default:\n        break;\n    }\n  }\n\n  getContext(collection) {\n    const c = this._private.collections[collection];\n    if (!c) return this._private.global.contextRef;\n    return {\n      ...this._private.global.contextRef,\n      ...c.methods,\n      data: c.public.object,\n      indexes: c.indexes.object,\n      groups: c.public.object,\n      computed: c.public.object,\n      routes: c.public.object.routes,\n      local: c.local\n    };\n  }\n\n  install(Vue) {\n    this._private.global.config.framework = 'vue';\n    const pulse = this;\n    const config = pulse._private.global.config;\n    Vue.mixin({\n      beforeCreate() {\n        Object.keys(pulse._private.global.contextRef).forEach(collection => {\n          this['$' + collection] = pulse._private.global.contextRef[collection];\n        });\n\n        if (pulse.utils) this.$utils = pulse.utils;\n        if (pulse.services) this.$services = pulse.services;\n        if (pulse.staticData) this.$staticData = pulse.staticData;\n\n        this.mapData = properties =>\n          pulse.mapData(\n            properties,\n            this,\n            {\n              waitForMount: config.waitForMount\n            },\n            pulse\n          );\n      },\n      mounted() {\n        if (this.__pulseUniqueIdentifier && config.waitForMount)\n          pulse.mount(this);\n      },\n      beforeDestroy() {\n        if (this.__pulseUniqueIdentifier && config.autoUnmount)\n          pulse.unmount(this);\n      }\n    });\n  }\n\n  mount(instance) {\n    this._private.global.subs.mount(instance);\n  }\n\n  unmount(instance) {\n    this._private.global.subs.unmount(instance);\n  }\n\n  mapData(properties, instance = {}, _config = {}, pulseAlias?: any) {\n    let pulse = pulseAlias ? pulseAlias : this;\n    const config = {\n      waitForMount: true,\n      ..._config\n    };\n    const componentUUID = pulse._private.global.subs.registerComponent(\n      instance,\n      config\n    );\n    // new cool mapData method\n    if (typeof properties === 'function') {\n      return pulse._private.global.subs.subscribePropertiesToComponents(\n        properties,\n        componentUUID\n      );\n      // legacy support....\n    } else if (typeof properties === 'object') {\n      let returnData = {};\n      normalizeMap(properties).forEach(({ key, val }) => {\n        let collection = val.split('/')[0];\n        let property = val.split('/')[1];\n        let c = pulse._private.global.getContext()[collection];\n        returnData[\n          key\n        ] = pulse._private.global.subs.subscribePropertiesToComponents(() => {\n          return { [key]: c[property] };\n        }, componentUUID)[key];\n      });\n      return returnData;\n    }\n  }\n\n  createForeignGroupRelation(\n    foreignCollection,\n    foreignData,\n    dependentCollection,\n    dependentGroup\n  ) {\n    this._private.collections[foreignCollection].foreignGroupRelations[\n      foreignData\n    ] = {\n      collection: dependentCollection,\n      groupToRegen: dependentGroup\n    };\n  }\n\n  emit(name: string, payload: any): void {\n    if (this._private.events[name])\n      for (let i = 0; i < this._private.events[name].length; i++) {\n        const callback = this._private.events[name][i];\n        callback(payload);\n      }\n  }\n  on(name: string, callback: () => any): void {\n    if (!Array.isArray(this._private.events[name]))\n      this._private.events[name] = [callback];\n    else this._private.events[name].push(callback);\n  }\n}\n"],"names":["tslib_1.__extends","_typeof","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","withPulse","pulse","React","ReactComponent","selectData","props","state","mapData","waitForMount","_private","global","config","mount","autoUnmount","unmount","createElement","Component","Base"],"mappings":"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"}